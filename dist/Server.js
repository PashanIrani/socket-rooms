/*! For license information please see Server.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={"./src/common/Events.ts":(__unused_webpack_module,exports)=>{eval('\nObject.defineProperty(exports, "__esModule", ({ value: true }));\nexports["default"] = {\n    JOIN_ROOM: \'join room\'\n};\n\n\n//# sourceURL=webpack://SocketRooms/./src/common/Events.ts?')},"./src/common/Room.ts":(__unused_webpack_module,exports)=>{eval('\nObject.defineProperty(exports, "__esModule", ({ value: true }));\nexports.Room = void 0;\nclass Room {\n    constructor(id, capacity) {\n        this.capacity = null;\n        this.members = [];\n        this.id = id;\n        if (capacity) {\n            this.capacity = capacity;\n        }\n    }\n    addMember(member) {\n        this.members.push(member);\n    }\n    removeMember(id) {\n        this.members = this.members.filter((member) => {\n            return member.id !== id;\n        });\n    }\n}\nexports.Room = Room;\n\n\n//# sourceURL=webpack://SocketRooms/./src/common/Room.ts?')},"./src/server/index.ts":function(__unused_webpack_module,exports,__webpack_require__){eval('\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { "default": mod };\n};\nObject.defineProperty(exports, "__esModule", ({ value: true }));\nconst Room_1 = __webpack_require__(/*! src/common/Room */ "./src/common/Room.ts");\nconst Events_1 = __importDefault(__webpack_require__(/*! src/common/Events */ "./src/common/Events.ts"));\nlet rooms = {};\nlet members = {};\nfunction logState() {\n    console.log(rooms);\n    console.log(members);\n}\nconst createRoom = (roomId, capacity) => {\n    if (roomId in rooms) {\n        console.error(`Room ${roomId} already exists.`);\n        return;\n    }\n    const newRoom = new Room_1.Room(roomId, capacity);\n    rooms[roomId] = newRoom;\n    console.debug(`✨ Room ${roomId} Created.`);\n};\nconst joinRoom = (data, socket) => {\n    console.log(data);\n    let { member, roomId } = data;\n    if (!rooms.hasOwnProperty(roomId))\n        return;\n    socket.join(data.roomId);\n    member.rooms.push(rooms[data.roomId]);\n    members[member.id] = member;\n    rooms[data.roomId].addMember(data.member);\n    console.debug(`🟢 ${socket.id} joined Room [RoomId: ${roomId}]`);\n    logState();\n};\nconst disconnectCallback = (socket) => {\n    if (members[socket.id] == undefined) {\n        console.error("Member doesn\'t exist.");\n        return;\n    }\n    members[socket.id].rooms.forEach((room) => {\n        room.removeMember(socket.id);\n    });\n    delete members[socket.id];\n    console.debug(`❌ ${socket.id} disconnected `);\n    logState();\n};\nconst socketBehavior = (socket) => {\n    socket.on(Events_1.default.JOIN_ROOM, (data) => joinRoom(data, socket));\n    socket.on(\'disconnecting\', () => disconnectCallback(socket));\n};\nconst init = (Server) => {\n    const io = Server;\n    io.on(\'connection\', socketBehavior);\n};\nexports["default"] = { init, createRoom };\n\n\n//# sourceURL=webpack://SocketRooms/./src/server/index.ts?')}},__webpack_module_cache__={};function __webpack_require__(e){var o=__webpack_module_cache__[e];if(void 0!==o)return o.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}var __webpack_exports__=__webpack_require__("./src/server/index.ts");module.exports.SocketRoomsServer=__webpack_exports__.default})();